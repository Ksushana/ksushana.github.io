"use strict";!function(e){e.matches=e.matches||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector,e.closest=e.closest||function(e){return this?this.matches(e)?this:this.parentElement?this.parentElement.closest(e):null:null}}(Element.prototype),window.utils={escPressHandler:function(e,t){"Escape"===e.key&&t()}},document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector(".your-order");if(null!==t){var r=t.querySelector(".your-order__top-cart span"),o=t.querySelector(".your-order__info-sum span"),e=t.querySelector(".your-order__form");window.calcSumCartHandler=function(){var e=t.querySelectorAll(".your-order__item"),s=0;[].forEach.call(e,function(e){var t=e.querySelector(".your-order__desc-label-count input").value,r=parseInt(e.querySelector(".your-order__price span").textContent.replace(/ /,""),10),o=e.querySelector(".your-order__label input").checked;t=0!==t.length?parseInt(t,10):0,o&&(s+=t*r)}),o.textContent=s.toString().replace(/(\d)(?=(\d{3})+(\D|$))/g,"$1 "),r.textContent=e.length},calcSumCartHandler(),e.addEventListener("input",calcSumCartHandler),t.addEventListener("click",function(e){var t=e.target.closest(".your-order__item");if(t){var r=e.target.closest(".your-order__desc-button--decrement"),o=e.target.closest(".your-order__desc-button--increment"),s=t.querySelector(".your-order__desc-button--decrement"),c=t.querySelector(".your-order__desc-button--increment"),n=t.querySelector(".your-order__desc-label-count input"),d=parseInt(n.value,10);r&&(0<d&&(d--,n.value=d,calcSumCartHandler()),d<=0&&s.classList.add("your-order__desc-button--disabled"),d<9999&&c.classList.contains("your-order__desc-button--disabled")&&c.classList.remove("your-order__desc-button--disabled")),o&&(d<9999&&(d++,n.value=d,calcSumCartHandler()),9999<=d&&c.classList.add("your-order__desc-button--disabled"),0<d&&s.classList.contains("your-order__desc-button--disabled")&&s.classList.remove("your-order__desc-button--disabled"))}})}}),window.getTemplateCartItem=function(e){var t,r,o=e.querySelector(".picked-items__td--first .picked-items__img").src,s=e.querySelector(".picked-items__td--second").textContent.trim().replace(/\n/,""),c=e.querySelector(".picked-items__td--third .picked-items__td-transform").textContent.replace(/\n/,""),n=e.querySelector(".picked-items__td--fourth .picked-items__td-transform").textContent.replace(/\n/,"").trim(),d=e.querySelector(".picked-items__td--fifth .picked-items__td-transform").textContent.replace(/\n/,""),a=e.querySelector(".picked-items__td--sixth .picked-items__td-transform").textContent.replace(/\n/,""),l=e.querySelector(".picked-items__td--eighth").textContent,i=e.querySelector(".picked-items__td--ninth .picked-items__input").value;return n=n[0].charAt(0).toLowerCase()+n.slice(1),l=l.replace(/₽/,"").trim(),i=0===i.length?1:i,t='<li class="your-order__item"><label class="your-order__label"><span class="visually-hidden">Товар выбран</span><input class="visually-hidden" type="checkbox" name="'+s+'" checked><span></span></label><div class="your-order__img-wrapper"><img src="'+o+'" alt="Изображение товара"></div><div class="your-order__desc-wrapper"><p class="your-order__desc-title">'+d+'</p><p class="your-order__desc-name">'+c+" "+n+" "+a+'</p><p class="your-order__desc-name your-order__desc-name--article">арт. '+s+'</p><p class="your-order__desc-available">Есть в наличии на складе - <span>156</span> шт.</p><div class="your-order__desc-bottom"><button class="your-order__desc-button your-order__desc-button--decrement" type="button" title="Минус">-</button><label class="your-order__desc-label-count"><input type="number" name="count-pro-spero-grace-art-312010" value="'+i+'"></label><button class="your-order__desc-button your-order__desc-button--increment" type="button" title="Плюс">+ </button><div class="your-order__price-wrapper"><p class="your-order__price-desc">Цена за рул</p><p class="your-order__price"><span>'+l+'</span> ₽</p></div><div class="your-order__price-wrapper your-order__price-wrapper--old"><p class="your-order__price-desc">Старая цена</p><p class="your-order__price"><span>11 400</span> ₽</p></div></div></div></li>',(r=document.createElement("div")).innerHTML=t.trim(),r.firstChild},function(){var e=document.querySelector(".your-order__top-button");if(null!==e){var t=document.querySelector(".common-page__your-order"),r=e.querySelector("span");e.addEventListener("click",function(){t.classList.toggle("common-page__your-order--show"),t.classList.toggle("your-order--show"),t.classList.contains("your-order--show")?r.textContent="Свернуть":r.textContent="Развернуть"})}}(),function(){var e=document.querySelector(".picked-items");if(null!==e){var r=window.matchMedia("(max-width: 1920px)"),o=document.querySelector(".common-page__sidebar"),s=document.querySelector(".common-page__your-order"),c=s.querySelector(".your-order__list"),n=!1;e.addEventListener("click",function(e){var t=e.target.closest(".picked-items__tr");if(e.target.closest(".picked-items__button:not(.picked-items__button--ok)")){if(e.target.classList.add("picked-items__button--ok"),c.appendChild(getTemplateCartItem(t)),calcSumCartHandler(),n&&!0===r.matches)return;o.classList.add("common-page__sidebar--show-animation"),s.classList.add("common-page__your-order--show","your-order--show"),setTimeout(function(){o.classList.add("common-page__sidebar--only-icon","sidebar--only-icon")},450),setTimeout(function(){o.classList.remove("common-page__sidebar--show-animation")},500),n=!0}})}}(),function(){var e=document.querySelector(".your-order__submit");if(null!==e){var t=document.querySelector("body"),r=document.querySelector(".new-modal--your-order"),o=r.querySelector(".new-modal__form"),s=function(e){window.utils.escPressHandler(e,c)},c=function(){r.classList.remove("new-modal--show"),r.classList.remove("new-modal--successful"),document.removeEventListener("keydown",s),r.removeEventListener("click",n),o.removeEventListener("submit",d),t.classList.remove("no-scroll")},n=function(e){null!==e.target.closest(".new-modal__box")&&"new-modal__close"!==e.target.classList.value||c()},d=function(e){e.preventDefault(),r.classList.add("new-modal--successful")};e.addEventListener("click",function(e){e.preventDefault(),r.classList.add("new-modal--show"),t.classList.add("no-scroll"),document.addEventListener("keydown",s),r.addEventListener("click",n),o.addEventListener("submit",d)})}}();